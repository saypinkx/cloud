1. Вопросы для разогрева
1)Расскажите, с какими задачами в направлении безопасной разработки вы сталкивались?
2)Если вам приходилось проводить security code review или моделирование угроз, расскажите, как это было?
3)Если у вас был опыт поиска уязвимостей, расскажите, как это было?
4)Почему вы хотите участвовать в стажировке?

1.1 - Я работал backend разработчком с августа 2023 по конец февраля 2024 года, поэтому мне приходилось уделять время на безопасность. Безопасность рассматривал именно на самом этапе разрабоки + написание тестов из примеров - прописывал middleware, ограничивающий запросы для пользователей без ключей, так же тестировал api на риск утечки данных и прочее. В общем, обычные будни бэкендера)
1.2 - Да, приходилось, в плане безопасности в моей компании все было довольно строго, поэтому важные с точки зрения безопасности участки кода приходилось проверять нескольким людям и я входил в их число.
Конечно находились ошибки как у меня, так и у моих коллег, потому что у безопасности действительно много ньюансов. Так же командно рисовали диаграммы DFD, применяя к ним разные подходы поиска уязвимостей, для моделирования возможных угроз.
1.3 - Ну как я уже и сказал выше, да, опыт был, а мои впечатления описаны выше.
1.4 - Я в действительно чувствую, что у меня есть пробелы в званиниях ИБ, да и в целом это интересная для меня тема, поэтому я бы хотел попасть на стажировку, чтобы набраться нужного опыта и развиваться в этом направлении. Мечта детства - стать хакером :)

2. Security code review
Часть 1. Security code review: GO
Требуется провести анализ кода на GO с точки зрения безопасности и подготовить отчет по следующим пунктам:

1)Какие уязвимости присутствуют в этом фрагменте кода?
2)Указать строки, в которых присутствуют уязвимости.
3)К каким последствиям может привести эксплуатация найденных уязвимостей злоумышленником?
4)Описать способы исправления уязвимостей.
5)Если уязвимость можно исправить несколькими способами, необходимо перечислить их, выбрать лучший по вашему мнению и аргументировать свой выбор.

package main

import (
    "database/sql"
    "fmt"
    "log"
    "net/http"
    "github.com/go-sql-driver/mysql"
)

var db *sql.DB
var err error

func initDB() {
    db, err = sql.Open("mysql", "user:password@/dbname")
    if err != nil {
        log.Fatal(err)
    }

err = db.Ping()
if err != nil {
    log.Fatal(err)
    }
}

func searchHandler(w http.ResponseWriter, r *http.Request) {
    if r.Method != "GET" {
        http.Error(w, "Method is not supported.", http.StatusNotFound)
        return
    }

searchQuery := r.URL.Query().Get("query")
if searchQuery == "" {
    http.Error(w, "Query parameter is missing", http.StatusBadRequest)
    return
}

query := fmt.Sprintf("SELECT * FROM products WHERE name LIKE '%%%s%%'", searchQuery)
rows, err := db.Query(query)
if err != nil {
    http.Error(w, "Query failed", http.StatusInternalServerError)
    log.Println(err)
    return
}
defer rows.Close()

var products []string
for rows.Next() {
    var name string
    err := rows.Scan(&name)
    if err != nil {
        log.Fatal(err)
    }
    products = append(products, name)
}

fmt.Fprintf(w, "Found products: %v\n", products)
}

func main() {
    initDB()
    defer db.Close()

http.HandleFunc("/search", searchHandler)
fmt.Println("Server is running")
log.Fatal(http.ListenAndServe(":8080", nil))
}

2.1 - Предисловие - Я конечно не go-шник, но поастарался +- разобраться в коде, поэтому не судите меня строго.
2.1.1 - Самая очевидная вещь, которая сразу же бросилась мне в глаза - это SQL запрос.
2.1.2 - query := fmt.Sprintf("SELECT * FROM products WHERE name LIKE '%%%s%%'", searchQuery)
2.1.3 - Это может привести к утечки данных из таблицы products, или вызвать шквал ошибок при самом запросе.
2.1.4-5 - Ну для начала, я бы как-то валидировал щначение searchQuery, по типу данных, длине и т.п. В идеале - не обращался по полю name.


Часть 2: Security code review: Python
Требуется определить тип уязвимости в примерах кода на Python и ответить на следующие вопросы:

1)Указать строки, в которых присутствуют уязвимости.
2)К каким последствиям может привести эксплуатация данных уязвимостей злоумышленником?
3)Описать способы исправления уязвимостей.
4)Если уязвимость можно исправить несколькими способами, необходимо перечислить их, выбрать лучший по вашему мнению и аргументировать свой выбор.
Пример №2.1

from flask import Flask, request
from jinja2 import Template

app = Flask(name)

@app.route("/page")
def page():
    name = request.values.get('name')
    age = request.values.get('age', 'unknown')
    output = Template('Hello ' + name + '! Your age is ' + age + '.').render()
return output

if name == "main":
    app.run(debug=True)
    
2.2.1 - output = Template('Hello ' + name + '! Your age is ' + age + '.').render()
2.2.2 - Встраивание вместо переменных name и age какого-нибудь испольняемого JS кода (XSS - атаки)
2.2.3 - Нельзя производить рендеринг страницы таким образом, нужно сформировать HTMl страницу сразу, либо использовать фильтры, которые сделют участки кода неисполняемыми ( name|e, age|e)
2.2.4 - Оба способа будут достаточно эффективными.


Пример №2.2

from flask import Flask, request
import subprocess

app = Flask(name)

@app.route("/dns")
def dns_lookup():
    hostname = request.values.get('hostname')
    cmd = 'nslookup ' + hostname
    output = subprocess.check_output(cmd, shell=True, text=True)
return output
if name == "main":
    app.run(debug=True)

2.3.1 - cmd = 'nslookup ' + hostname 
2.3.2 - Выполение вредоносных, опасных команд на сервере. (Командная иньекция)
2.3.3 - Самое очевидное - валидировать hostname, проверять, действительно ли это hostname, или какая-то друшая команда и только в этом случае выполнять дальнейшие участки кода.
2.3.4 - Так же можно использовать специализированные библиотеки как дополнение, чтобы выполнялись только безопасные команды для сервера.

3
Проанализируйте диаграмму потоков данных приложения и ответьте на следующий вопросы:

Расскажите, какие потенциальные проблемы безопасности существуют для данного сервиса?
Расскажите, к каким последствиям может привести эксплуатация проблем, найденных вами?
Расскажите, какие способы исправления уязвимостей и смягчения рисков вы можете предложить по отмеченным вами проблемам безопасности?
Напишите список уточняющих вопросов, которые вы бы задали разработчикам данного сервиса?

3.1 DoS атаки
3.2 Не возможность выдержать нагрузку - падения прода
3.3 Подключение CDN
3.4 
1 - Есть ли двухэтапорка ?
2 - Есть ли проверка идентификационного токена ?
3 - Разрешения авторизированного юзера  ?
4 - Есть ли шифрование паролей ? (если логин по паролю)
